<div class="col-sm-12 col-lg-6">
  <form name="nfsForm"
        class="form-horizontal"
        #formDir="ngForm"
        [formGroup]="nfsForm"
        novalidate>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"
            i18n>NFS export {{ id }}</h3>
      </div>

      <div class="panel-body">

        <!-- Host -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('host', formDir)}">
          <label class="col-sm-3 control-label"
                 for="host">
            <ng-container i18n>Host</ng-container>
            <span class="required"></span>
          </label>
          <div class="col-sm-9">
            <select class="form-control"
                    formControlName="host"
                    name="host"
                    id="host">
              <option *ngIf="allHosts === null"
                      value=""
                      i18n>Loading...</option>
              <option *ngIf="allHosts !== null && allHosts.length === 0"
                      value=""
                      i18n>-- No hosts available --</option>
              <option *ngIf="allHosts !== null && allHosts.length > 0"
                      value=""
                      i18n>-- Select the host --</option>
              <option *ngFor="let host of allHosts"
                      [value]="host">{{ host }}</option>
            </select>
            <span class="help-block"
                  *ngIf="nfsForm.showError('host', formDir, 'required')"
                  i18n>Required field</span>
          </div>
        </div>

        <!-- FSAL -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('fsal', formDir)}">
          <label class="col-sm-3 control-label"
                 for="fsal">
            <ng-container i18n>Storage Backend</ng-container>
            <span class="required"></span>
          </label>
          <div class="col-sm-9">
            <select class="form-control"
                    formControlName="fsal"
                    name="fsal"
                    id="fsal"
                    (change)="fsalChangeHandler()">
              <option *ngIf="allFsals === null"
                      value=""
                      i18n>Loading...</option>
              <option *ngIf="allFsals !== null && allFsals.length === 0"
                      value=""
                      i18n>-- No data pools available --</option>
              <option *ngIf="allFsals !== null && allFsals.length > 0"
                      value=""
                      i18n>-- Select the storage backend --</option>
              <option *ngFor="let fsal of allFsals"
                      [value]="fsal.value">{{ fsal.descr }}</option>
            </select>
            <span class="help-block"
                  *ngIf="nfsForm.showError('fsal', formDir, 'required')"
                  i18n>Required field</span>
          </div>
        </div>

        <!-- RGW user -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('rgwUserId', formDir)}"
             *ngIf="nfsForm.getValue('fsal') === 'RGW'">
          <label class="col-sm-3 control-label"
                 for="rgwUserId">
            <ng-container i18n>Object Gateway User</ng-container>
            <span class="required"></span>
          </label>
          <div class="col-sm-9">
            <select class="form-control"
                    formControlName="rgwUserId"
                    name="rgwUserId"
                    id="rgwUserId"
                    (change)="rgwUserIdChangeHandler()">
              <option *ngIf="allRgwUsers === null"
                      value=""
                      i18n>Loading...</option>
              <option *ngIf="allRgwUsers !== null && allRgwUsers.length === 0"
                      value=""
                      i18n>-- No users available --</option>
              <option *ngIf="allRgwUsers !== null && allRgwUsers.length > 0"
                      value=""
                      i18n>-- Select the object gateway user --</option>
              <option *ngFor="let rgwUserId of allRgwUsers"
                      [value]="rgwUserId">{{ rgwUserId }}</option>
            </select>
            <span class="help-block"
                  *ngIf="nfsForm.showError('rgwUserId', formDir, 'required')"
                  i18n>Required field</span>
          </div>
        </div>

        <!-- Path -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('path', formDir)}"
             *ngIf="nfsForm.getValue('fsal') === 'CEPH'">
          <label class="col-sm-3 control-label"
                 for="path">
            <ng-container i18n>Ceph Path</ng-container>
            <span class="required"></span>
          </label>
          <div class="col-sm-9">
            <input type="text"
                   class="form-control"
                   name="path"
                   id="path"
                   formControlName="path"
                   autocomplete="off"
                   [typeahead]="pathDataSource"
                   (typeaheadOnSelect)="pathChangeHandler()"
                   (blur)="pathChangeHandler()">
            <span class="help-block"
                  *ngIf="nfsForm.showError('path', formDir, 'required')"
                  i18n>Required field</span>
            <span class="help-block"
                  *ngIf="isNewDirectory"
                  i18n>New directory will be created</span>
          </div>
        </div>

        <!-- Bucket -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('bucket', formDir)}"
             *ngIf="nfsForm.getValue('fsal') === 'RGW'">
          <label i18n
                 class="col-sm-3 control-label"
                 for="bucket">Bucket</label>
          <div class="col-sm-9">
            <input type="text"
                   class="form-control"
                   name="bucket"
                   id="bucket"
                   formControlName="bucket"
                   [typeahead]="bucketDataSource"
                   (typeaheadOnSelect)="bucketChangeHandler()"
                   (blur)="bucketChangeHandler()">
            <span class="help-block"
                  *ngIf="nfsForm.showError('bucket', formDir, 'required')"
                  i18n>Required field</span>
            <span class="help-block"
                  *ngIf="nfsForm.showError('bucket', formDir) && isNewBucket"
                  i18n>New bucket will be created</span>
          </div>
        </div>

        <!-- NFS Protocol -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('protocolNfsv3', formDir) || nfsForm.showError('protocolNfsv4', formDir)}">
          <label class="col-sm-3 control-label"
                 for="protocols">
            <ng-container i18n>NFS Protocol</ng-container>
            <span class="required"></span>
          </label>
          <div class="col-sm-9">
            <div class="checkbox checkbox-primary">
              <input type="checkbox"
                     id="protocolNfsv3"
                     name="protocolNfsv3"
                     formControlName="protocolNfsv3">
              <label i18n
                     for="protocolNfsv3">NFSv3</label>
            </div>
            <div class="checkbox checkbox-primary">
              <input type="checkbox"
                     formControlName="protocolNfsv4"
                     name="protocolNfsv4"
                     id="protocolNfsv4">
              <label i18n
                     for="protocolNfsv4">NFSv4</label>
            </div>
            <span class="help-block"
                  *ngIf="nfsForm.showError('protocolNfsv3', formDir, 'required') ||
                  nfsForm.showError('protocolNfsv4', formDir, 'required')"
                  i18n>Required field</span>
          </div>
        </div>

        <!-- Tag -->
        <div class="form-group"
             ng-if="nfsForm.getValue('protocolNfsv3')">
          <label class="col-sm-3 control-label"
                 for="tag">
            <ng-container i18n>NFS Tag</ng-container>
            <cd-helper>
              <p i18n>Alternative access for <strong>NFS v3</strong> mounts (it must not have a leading /).</p>
              <p i18n>Clients may not mount subdirectories (i.e. if Tag = foo, the client may not mount foo/baz).</p>
              <p i18n>By using different Tag options, the same Path may be exported multiple times.</p>
            </cd-helper>
          </label>
          <div class="col-sm-9">
            <input type="text"
                   class="form-control"
                   name="tag"
                   id="tag"
                   formControlName="tag">
          </div>
        </div>

        <!-- Pseudo -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('pseudo', formDir)}"
             ng-if="nfsForm.getValue('protocolNfsv4')">
          <label class="col-sm-3 control-label"
                 for="pseudo">
            <ng-container i18n>Pseudo</ng-container>
            <span class="required"></span>
            <cd-helper>
              <p i18n>The position that this <strong>NFS v4</strong> export occupies
                in the <strong>Pseudo FS</strong> (it must be unique).</p>
              <p i18n>By using different Pseudo options, the same Path may be exported multiple times.</p>
            </cd-helper>
          </label>
          <div class="col-sm-9">
            <input type="text"
                   class="form-control"
                   name="pseudo"
                   id="pseudo"
                   formControlName="pseudo">
            <span class="help-block"
                  *ngIf="nfsForm.showError('pseudo', formDir, 'required')"
                  i18n>Required field</span>
          </div>
        </div>

        <!-- Access Type -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('accessType', formDir)}">
          <label class="col-sm-3 control-label"
                 for="accessType">
            <ng-container i18n>Access Type</ng-container>
            <span class="required"></span>
          </label>
          <div class="col-sm-9">
            <select class="form-control"
                    formControlName="accessType"
                    name="accessType"
                    id="accessType">
              <option *ngIf="nfsAccessType === null"
                      value=""
                      i18n>Loading...</option>
              <option *ngIf="nfsAccessType !== null && nfsAccessType.length === 0"
                      value=""
                      i18n>-- No access type available --</option>
              <option *ngIf="nfsAccessType !== null && nfsAccessType.length > 0"
                      value=""
                      i18n>-- Select the access type --</option>
              <option *ngFor="let accessType of nfsAccessType"
                      [value]="accessType.value">{{ accessType.value }}</option>
            </select>
            <span class="help-block"
                  *ngIf="nfsForm.getValue('accessType')">
              {{ getAccessTypeHelp(nfsForm.getValue('accessType')) }}
            </span>
            <span class="help-block"
                  *ngIf="nfsForm.showError('accessType', formDir, 'required')"
                  i18n>Required field</span>
          </div>
        </div>

        <!-- Squash -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('squash', formDir)}">
          <label class="col-sm-3 control-label"
                 for="squash">
            <ng-container i18n>Squash</ng-container>
            <span class="required"></span>
          </label>
          <div class="col-sm-9">
            <select class="form-control"
                    name="squash"
                    formControlName="squash"
                    id="squash">
              <option *ngIf="nfsSquash === null"
                      value=""
                      i18n>Loading...</option>
              <option *ngIf="nfsSquash !== null && nfsSquash.length === 0"
                      value=""
                      i18n>-- No squash available --</option>
              <option *ngIf="nfsSquash !== null && nfsSquash.length > 0"
                      value=""
                      i18n>--Select what kind of user id squashing is performed --</option>
              <option *ngFor="let squash of nfsSquash"
                      [value]="squash">{{ squash }}</option>

            </select>
            <span class="help-block"
                  *ngIf="nfsForm.showError('squash', formDir,'required')"
                  i18n>Required field</span>
          </div>
        </div>

        <!-- Transport Protocol -->
        <div class="form-group"
             [ngClass]="{'has-error': nfsForm.showError('transportUDP', formDir) || nfsForm.showError('transportTCP', formDir)}">
          <label class="col-sm-3 control-label"
                 for="transports">
            <ng-container i18n>Transport Protocol</ng-container>
            <span class="required"></span>
          </label>
          <div class="col-sm-9">
            <div class="checkbox checkbox-primary">
              <input type="checkbox"
                     formControlName="transportUDP"
                     name="transportUDP"
                     id="transportUDP">
              <label for="transportUDP"
                     i18n>UDP</label>
            </div>
            <div class="checkbox checkbox-primary">
              <input type="checkbox"
                     formControlName="transportTCP"
                     name="transportTCP"
                     id="transportTCP">
              <label for="transportTCP"
                     i18n>TCP</label>
            </div>
            <span class="help-block"
                  *ngIf="nfsForm.showError('transportUDP', formDir, 'required') ||
                  nfsForm.showError('transportTCP', formDir, 'required')"
                  i18n>Required field</span>
            <hr>
          </div>
        </div>

        <!-- Client Blocks -->
        <cd-nfs-form-client [form]="nfsForm">
        </cd-nfs-form-client>

      </div>

      <div class="panel-footer">
        <div class="button-group text-right">
          <cd-submit-button [form]="formDir"
                            type="button"
                            (submitAction)="submitAction()">
            <ng-container i18n>Submit</ng-container>
          </cd-submit-button>
          <button type="button"
                  class="btn btn-sm btn-default"
                  (click)="cancelAction()"
                  i18n>Back</button>
        </div>
      </div>
    </div>
  </form>
</div>
