<!-- Main content -->
<section class="content"
         *ngIf="isReady">
  <div class="row">
    <div class="col-sm-6">
      <div class="box">
        <div class="box-header">
          Health
        </div>
        <div class="box-body">
          Overall status:
          <span [ngStyle]="content_data.health.status | healthColor">{{ content_data.health.status }}</span>

          <ul>
            <li *ngFor="let check of content_data.health.checks">
              <span [ngStyle]="check.severity | healthColor">{{check.type}}</span>: {{check.summary.message}}
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-sm-3">
      <div class="info-box">
        <span class="info-box-icon bg-grey">
          <i class="fa fa-database"></i>
        </span>

        <div class="info-box-content">
          <span class="info-box-text">Monitors</span>
          <span class="info-box-number">{{ content_data.mon_status | monSummary }}</span>
          <!-- | mon_summary -->
        </div>
      </div>
      <div class="info-box">
        <span class="info-box-icon bg-grey">
          <i class="fa fa-hdd-o"></i>
        </span>

        <div class="info-box-content">
          <span class="info-box-text">OSDs</span>
          <span class="info-box-number">{{content_data.osd_map | osdSummary}}</span>
        </div>
      </div>
    </div>

    <div class="col-sm-3">
      <div class="info-box">
        <span class="info-box-icon bg-grey">
          <i class="fa fa-folder"></i>
        </span>

        <div class="info-box-content">
          <span class="info-box-text">Metadata servers</span>
          <span class="info-box-number">{{content_data.fs_map | mdsSummary}}</span>
        </div>
      </div>
      <div class="info-box">
        <span class="info-box-icon bg-grey">
          <i class="fa fa-cog"></i>
        </span>

        <div class="info-box-content">
          <span class="info-box-text">Manager daemons</span>
          <span class="info-box-number">{{content_data.mgr_map | mgrSummary}}</span>
        </div>
      </div>
    </div>

  </div>

  <div class="row">
    <div class="col-sm-6">
      <div class="box">
        <div class="box-header">
          Usage
        </div>
        <div class="box-body"
             style="text-align:center;">
          <table class="ceph-chartbox">
            <tr>
              <td>
                <span style="font-size: 45px;">{{content_data.df.stats.total_objects | dimless}}</span>
              </td>
              <td>
                <div style="height:120px; width: 120px;">
                  <canvas baseChart
                          id="raw_usage_chart"
                          [datasets]="rawUsage.dataset"
                          [chartType]="rawUsage.chartType"
                          [options]="rawUsage.options"
                          [labels]="rawUsage.labels"
                          [colors]="rawUsage.colors"
                          width="120"
                          height="120"></canvas>
                </div>
              </td>
              <td>
                <div style="height:120px; width: 120px;">

                  <canvas baseChart
                          id="pool_usage_chart"
                          [datasets]="poolUsage.dataset"
                          [chartType]="poolUsage.chartType"
                          [options]="poolUsage.options"
                          [labels]="poolUsage.labels"
                          [colors]="poolUsage.colors"
                          width="120"
                          height="120"></canvas>
                </div>
              </td>
            </tr>
            <tr>
              <td>Objects</td>
              <td>Raw capacity
                <br>({{content_data.df.stats.total_used_bytes | dimlessBinary}} used)</td>
              <td>Usage by pool</td>
            </tr>
          </table>
        </div>
      </div>
    </div>

    <div class="col-sm-6">
      <div class="box">
        <div class="box-header">
          Pools
        </div>
        <div class="box-body">
          <cd-table [rows]="content_data.pools">
            <ngx-datatable-column name="Name"
                                  prop="pool_name">
            </ngx-datatable-column>
            <ngx-datatable-column name="PG status"
                                  prop="pg_status">
              <ng-template let-value="value"
                           ngx-datatable-cell-template>
                <div [ngStyle]="value | pgStatusStyle">
                  {{value | pgStatus}}
                </div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Usage"
                                  prop="stats"
                                  [sortable]="false">
              <ng-template let-value="value"
                           ngx-datatable-cell-template>
                {{value.bytes_used.latest | dimlessBinary}} / {{value.max_avail.latest | dimlessBinary}}

              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Activity"
                                  prop="stats"
                                  [sortable]="false">
              <ng-template let-value="value"
                           ngx-datatable-cell-template>
                {{value.rd_bytes.rate | dimless }} rd, {{ value.wr_bytes.rate | dimless }} wr
              </ng-template>
            </ngx-datatable-column>
          </cd-table>
        </div>
      </div>
    </div>
  </div>

  <div class="box">
    <div class="box-body">
      <ul class="nav nav-tabs">
        <li class="active">
          <a data-toggle="tab"
             href="#clog">Cluster log</a>
        </li>
        <li>
          <a data-toggle="tab"
             href="#audit_log">Audit log</a>
        </li>
      </ul>
      <div class="tab-content ceph-log">
        <div id="clog"
             class="tab-pane fade in active">
          <span>
            <span *ngFor="let line of content_data.clog">
              {{ line.stamp }}&nbsp;{{line.priority}}&nbsp;
              <span [ngStyle]="line | logColor">
                {{ line.message }}
                <br>
              </span>
            </span>
          </span>
        </div>
        <div id="audit_log"
             class="tab-pane fade in">
          <span>
            <span *ngFor="let line of content_data.audit_log">
              {{ line.stamp }}&nbsp;{{line.priority}}&nbsp;
              <span [ngStyle]="line | logColor">
                <span style="font-weight: bold;">
                  {{ line.message }}
                </span>
                <br>
              </span>
            </span>
          </span>

        </div>
      </div>

    </div>

  </div>
</section>
