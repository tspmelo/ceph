<section class="content-header">
  <h1>
    Block Mirroring
  </h1>
</section>

<section class="content">
  <div class="row">
    <div class="col-sm-6">
      <div class="box">
        <div class="box-header">
          <h3 class="box-title">Daemons</h3>
        </div>
        <div class="box-body">

          <cd-table [rows]="content_data.daemons">
            <ngx-datatable-column name="Instance"
                                  prop="instance_id"></ngx-datatable-column>
            <ngx-datatable-column name="ID"
                                  prop="id"></ngx-datatable-column>
            <ngx-datatable-column name="Hostname"
                                  prop="server_hostname"></ngx-datatable-column>
            <ngx-datatable-column name="Version"
                                  prop="version">
              <ng-template let-value="value"
                           ngx-datatable-cell-template>
                {{value | shortVersion}}
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Health"
                                  prop="health">
              <ng-template let-value="value"
                           let-row="row"
                           ngx-datatable-cell-template>
                <span [ngClass]="row.health_color | mirrorHealthColor">{{value}}</span>
              </ng-template>
            </ngx-datatable-column>
          </cd-table>
        </div>
      </div>
    </div>

    <div class="col-sm-6">
      <div class="box">
        <div class="box-header">
          <h3 class="box-title">Pools</h3>
        </div>
        <div class="box-body">
          <cd-table [rows]="content_data.pools">
            <ngx-datatable-column name="Name"
                                  prop="name"></ngx-datatable-column>
            <ngx-datatable-column name="Mode"
                                  prop="mirror_mode"></ngx-datatable-column>
            <ngx-datatable-column name="Leader"
                                  prop="leader_id"></ngx-datatable-column>
            <ngx-datatable-column name="# Local"
                                  prop="image_local_count"></ngx-datatable-column>
            <ngx-datatable-column name="# Remote"
                                  prop="image_remote_count"></ngx-datatable-column>
            <ngx-datatable-column name="Health"
                                  prop="health">
              <ng-template let-value="value"
                           let-row="row"
                           ngx-datatable-cell-template>
                <span [ngClass]="row.health_color | mirrorHealthColor">{{value}}</span>
              </ng-template>
            </ngx-datatable-column>
          </cd-table>
        </div>
      </div>
    </div>
  </div>

  <div class="box">
    <div class="box-header">
      <h3 class="box-title">Images</h3>
    </div>
    <div class="box-body">
      <div class="nav-tabs-custom">
        <ul class="nav nav-tabs">
          <li class="active">
            <a href="#tab_1"
               data-toggle="tab">Issues</a>
          </li>
          <li>
            <a href="#tab_2"
               data-toggle="tab">Syncing</a>
          </li>
          <li>
            <a href="#tab_3"
               data-toggle="tab">Ready</a>
          </li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane active"
               id="tab_1">

            <cd-table [rows]="content_data.image_error"
                      filter="true">
              <ngx-datatable-column name="Pool"
                                    prop="pool_name"></ngx-datatable-column>
              <ngx-datatable-column name="Image"
                                    prop="name"></ngx-datatable-column>
              <ngx-datatable-column name="Issue"
                                    prop="description"></ngx-datatable-column>
              <ngx-datatable-column name="State"
                                    prop="state">
                <ng-template let-value="value"
                             let-row="row"
                             ngx-datatable-cell-template>
                  <span [ngClass]="row.state_color | mirrorHealthColor">{{value}}</span>
                </ng-template>
              </ngx-datatable-column>
            </cd-table>
          </div>
          <div class="tab-pane"
               id="tab_2">
            <table id="image_syncing"
                   class="table table-condensed">
              <thead>
                <tr>
                  <th>Pool</th>
                  <th>Image</th>
                  <th>Progress</th>
                  <th>State</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let image of content_data.image_syncing">
                  <td>{{image.pool_name}}</td>
                  <td>{{image.name}}</td>
                  <td>
                    <div class="progress"
                         style="width: 100px; height: 18px;">
                      <div class="progress-bar progress-bar-aqua"
                           [ngStyle]="image.progress | syncProgressBar">
                        {{image.progress}}
                      </div>
                    </div>
                  </td>
                  <td>
                    <span class="label label-info">Syncing</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="tab-pane"
               id="tab_3">
            <table id="image_ready"
                   class="table table-condensed">
              <thead>
                <tr>
                  <th>Pool</th>
                  <th>Image</th>
                  <th>Description</th>
                  <th>State</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let image of content_data.image_ready">
                  <td>{{image.pool_name}}</td>
                  <td>{{image.name}}</td>
                  <td>{{image.description}}</td>
                  <td>
                    <span [ngClass]="image.state_color | mirrorHealthColor">{{image.state}}</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
